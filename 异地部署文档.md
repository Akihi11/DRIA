# DRIA å¼‚åœ°éƒ¨ç½²æ–‡æ¡£

> **é€‚ç”¨åœºæ™¯**ï¼šä¸»é¡¹ç›®ä¸€è‡´ï¼ˆclone è‡ªåŒä¸€ä»“åº“ï¼‰çš„å¼‚åœ°éƒ¨ç½²

## ğŸ“‹ ç›®å½•

- [å‰ææ¡ä»¶](#å‰ææ¡ä»¶)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [éªŒè¯éƒ¨ç½²](#éªŒè¯éƒ¨ç½²)
- [å¸¸ç”¨å‘½ä»¤](#å¸¸ç”¨å‘½ä»¤)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## å‰ææ¡ä»¶

### âœ… å¿…éœ€æ¡ä»¶

1. **å·²å®‰è£… Docker**ï¼ˆç‰ˆæœ¬ 20.10+ï¼‰

   ```bash
   docker --version
   ```

2. **å·²å®‰è£… Docker Compose**ï¼ˆç‰ˆæœ¬ 2.0+ï¼‰

   ```bash
   docker-compose --version
   ```

3. **ä¸»é¡¹ç›®å·²éƒ¨ç½²å¹¶è¿è¡Œ**
   - ä¸»é¡¹ç›®çš„ PostgreSQL æœåŠ¡ï¼ˆ`poc-pg`ï¼‰æ­£åœ¨è¿è¡Œ
   - ä¸»é¡¹ç›®çš„ Ollama æœåŠ¡ï¼ˆ`poc-ollama`ï¼‰æ­£åœ¨è¿è¡Œ
   - ä¸»é¡¹ç›®çš„ Docker ç½‘ç»œï¼ˆ`dhcf-poc-fixed_core-net`ï¼‰å·²åˆ›å»º

### ğŸ” éªŒè¯ä¸»é¡¹ç›®çŠ¶æ€

åœ¨éƒ¨ç½² DRIA ä¹‹å‰ï¼Œè¯·å…ˆç¡®è®¤ä¸»é¡¹ç›®æœåŠ¡æ­£å¸¸è¿è¡Œï¼š

```bash
# æ£€æŸ¥ä¸»é¡¹ç›®å®¹å™¨æ˜¯å¦è¿è¡Œ
docker ps | grep poc-pg
docker ps | grep poc-ollama

# æ£€æŸ¥ä¸»é¡¹ç›®ç½‘ç»œæ˜¯å¦å­˜åœ¨
docker network ls | grep dhcf-poc-fixed_core-net
```

å¦‚æœä»¥ä¸Šå‘½ä»¤éƒ½èƒ½æ‰¾åˆ°å¯¹åº”çš„å®¹å™¨å’Œç½‘ç»œï¼Œè¯´æ˜ä¸»é¡¹ç›®å·²æ­£ç¡®éƒ¨ç½²ã€‚

## å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1ï¼šå‡†å¤‡ç¯å¢ƒå˜é‡æ–‡ä»¶

**é‡è¦ï¼š`.env.docker` æ–‡ä»¶å¿…é¡»æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼ˆä¸ `docker-compose.yml` åŒçº§ï¼‰**

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ
cp env.docker.example .env.docker
```

**æ–‡ä»¶ä½ç½®ç¤ºä¾‹ï¼š**

```
DRIA/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env.docker          â† æ”¾åœ¨è¿™é‡Œï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰
â”œâ”€â”€ env.docker.example
â”œâ”€â”€ backend/
â””â”€â”€ frontend/
```

### æ­¥éª¤ 2ï¼šé…ç½®æ•°æ®åº“è¿æ¥

ç¼–è¾‘ `.env.docker` æ–‡ä»¶ï¼Œé…ç½®ä¸»é¡¹ç›®çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼š

```env
# ====================
# ä¸»é¡¹ç›®PostgreSQLé…ç½®
# ====================
# æ–¹å¼1: ä½¿ç”¨å®Œæ•´çš„è¿æ¥å­—ç¬¦ä¸²ï¼ˆæ¨èï¼‰
DATABASE_URL=postgresql+psycopg2://admin:admin123@poc-pg:5432/unified_db

# æ–¹å¼2: ä½¿ç”¨åˆ†ç¦»çš„é…ç½®é¡¹ï¼ˆå¦‚æœæ–¹å¼1ä¸å·¥ä½œï¼‰
POSTGRES_HOST=poc-pg
POSTGRES_PORT=5432
POSTGRES_DB=unified_db
POSTGRES_USER=admin
POSTGRES_PASSWORD=admin123
```

**æ³¨æ„ï¼š**

- å¦‚æœä¸»é¡¹ç›®çš„æ•°æ®åº“é…ç½®ä¸é»˜è®¤å€¼ä¸åŒï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹
- é»˜è®¤å€¼ï¼šæ•°æ®åº“å `unified_db`ï¼Œç”¨æˆ·å `admin`ï¼Œå¯†ç  `admin123`
- æœåŠ¡åç§° `poc-pg` å·²åœ¨ `docker-compose.yml` ä¸­é¢„è®¾ï¼Œæ— éœ€ä¿®æ”¹

### æ­¥éª¤ 3ï¼šé…ç½® Ollama è¿æ¥

åœ¨ `.env.docker` æ–‡ä»¶ä¸­é…ç½® Ollamaï¼š

```env
# ====================
# ä¸»é¡¹ç›®Ollamaé…ç½®
# ====================
# OllamaæœåŠ¡åœ°å€ï¼ˆä½¿ç”¨ä¸»é¡¹ç›®çš„æœåŠ¡åç§°ï¼‰
OLLAMA_URL=http://poc-ollama:11434

# Ollamaæ¨¡å‹åç§°ï¼ˆæ ¹æ®å®é™…ä½¿ç”¨çš„æ¨¡å‹ä¿®æ”¹ï¼‰
OLLAMA_MODEL=llama2
```

**æ³¨æ„ï¼š**

- æœåŠ¡åç§° `poc-ollama` å·²åœ¨ `docker-compose.yml` ä¸­é¢„è®¾ï¼Œæ— éœ€ä¿®æ”¹
- å¦‚æœä½¿ç”¨å…¶ä»–æ¨¡å‹ï¼ˆå¦‚ `llama3`ã€`qwen` ç­‰ï¼‰ï¼Œè¯·ä¿®æ”¹ `OLLAMA_MODEL` çš„å€¼

### æ­¥éª¤ 4ï¼šå…¶ä»–é…ç½®ï¼ˆå¯é€‰ï¼‰

```env
# ====================
# åº”ç”¨é…ç½®
# ====================
DEBUG=False
LOG_LEVEL=INFO
DEFAULT_LLM_PROVIDER=local

# ====================
# æ–‡ä»¶ä¸Šä¼ é…ç½®
# ====================
MAX_FILE_SIZE=104857600  # 100MB
ALLOWED_EXTENSIONS=.csv,.xlsx,.xls
```

### æ­¥éª¤ 5ï¼šæ„å»ºå’Œå¯åŠ¨æœåŠ¡

```bash
# æ„å»ºé•œåƒï¼ˆé¦–æ¬¡éƒ¨ç½²æˆ–æ›´æ–°ä»£ç åï¼‰
docker-compose build

# å¯åŠ¨æœåŠ¡ï¼ˆåå°è¿è¡Œï¼‰
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

### æ­¥éª¤ 6ï¼šéªŒè¯éƒ¨ç½²

ç­‰å¾…æœåŠ¡å¯åŠ¨å®Œæˆåï¼ˆçº¦ 30-60 ç§’ï¼‰ï¼Œè®¿é—®ä»¥ä¸‹åœ°å€éªŒè¯ï¼š

- ğŸŒ **å‰ç«¯è®¿é—®**: http://localhost
- ğŸ”§ **åç«¯ API**: http://localhost:8001
- ğŸ“š **API æ–‡æ¡£**: http://localhost:8001/api/docs
- â¤ï¸ **å¥åº·æ£€æŸ¥**: http://localhost:8001/api/health

**å¥åº·æ£€æŸ¥é¢„æœŸè¿”å›ï¼š**

```json
{
  "status": "healthy",
  "timestamp": "2025-01-01T12:00:00",
  "version": "1.0.0"
}
```

## é…ç½®è¯´æ˜

### å·²é¢„è®¾çš„é…ç½®ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

å¦‚æœä¸»é¡¹ç›®ä¸€è‡´ï¼ˆclone è‡ªåŒä¸€ä»“åº“ï¼‰ï¼Œä»¥ä¸‹é…ç½®å·²åœ¨ `docker-compose.yml` ä¸­é¢„è®¾å¥½ï¼Œ**æ— éœ€ä¿®æ”¹**ï¼š

- âœ… **ç½‘ç»œåç§°**: `dhcf-poc-fixed_core-net`ï¼ˆç¬¬ 101 è¡Œï¼‰
- âœ… **PostgreSQL æœåŠ¡å**: `poc-pg`ï¼ˆç¬¬ 61 è¡Œï¼‰
- âœ… **Ollama æœåŠ¡å**: `poc-ollama`ï¼ˆç¬¬ 22 è¡Œï¼‰
- âœ… **æ•°æ®åº“é»˜è®¤å€¼**: `unified_db`ã€`admin`ã€`admin123`ï¼ˆç¬¬ 63-65 è¡Œï¼‰
- âœ… **ç«¯å£æ˜ å°„**: åç«¯ `8001:8000`ï¼Œå‰ç«¯ `80:80`ï¼ˆç¬¬ 11ã€84 è¡Œï¼‰

### éœ€è¦é…ç½®çš„å†…å®¹

**ä¸»è¦é…ç½® `.env.docker` æ–‡ä»¶ä¸­çš„ä»¥ä¸‹å†…å®¹ï¼š**

1. **æ•°æ®åº“è¿æ¥ä¿¡æ¯**ï¼ˆå¿…éœ€ï¼‰

   - å¦‚æœä¸»é¡¹ç›®çš„æ•°æ®åº“é…ç½®ä¸é»˜è®¤å€¼ä¸åŒï¼Œéœ€è¦ä¿®æ”¹
   - å¦‚æœä½¿ç”¨é»˜è®¤å€¼ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç¤ºä¾‹æ–‡ä»¶ä¸­çš„é…ç½®

2. **Ollama æ¨¡å‹åç§°**ï¼ˆå»ºè®®ï¼‰

   - æ ¹æ®å®é™…ä½¿ç”¨çš„æ¨¡å‹ä¿®æ”¹ `OLLAMA_MODEL`

3. **å…¶ä»– LLM é…ç½®**ï¼ˆå¯é€‰ï¼‰
   - å¦‚æœéœ€è¦ä½¿ç”¨ DeepSeekã€Kimiã€OpenAI ç­‰ï¼Œå–æ¶ˆæ³¨é‡Šå¹¶å¡«å†™ API å¯†é’¥

### å®Œæ•´é…ç½®ç¤ºä¾‹

`.env.docker` æ–‡ä»¶å®Œæ•´ç¤ºä¾‹ï¼ˆä½¿ç”¨é»˜è®¤å€¼ï¼‰ï¼š

```env
# ====================
# ä¸»é¡¹ç›®PostgreSQLé…ç½®
# ====================
DATABASE_URL=postgresql+psycopg2://admin:admin123@poc-pg:5432/unified_db

# ====================
# ä¸»é¡¹ç›®Ollamaé…ç½®
# ====================
OLLAMA_URL=http://poc-ollama:11434
OLLAMA_MODEL=llama2

# ====================
# åº”ç”¨é…ç½®
# ====================
DEBUG=False
LOG_LEVEL=INFO
DEFAULT_LLM_PROVIDER=local

# ====================
# æ–‡ä»¶ä¸Šä¼ é…ç½®
# ====================
MAX_FILE_SIZE=104857600
ALLOWED_EXTENSIONS=.csv,.xlsx,.xls
```

## éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥å®¹å™¨çŠ¶æ€

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker-compose ps

# é¢„æœŸè¾“å‡ºåº”è¯¥æ˜¾ç¤ºæ‰€æœ‰æœåŠ¡éƒ½æ˜¯ "Up" çŠ¶æ€
```

### 2. æ£€æŸ¥ç½‘ç»œè¿æ¥

```bash
# è¿›å…¥åç«¯å®¹å™¨
docker-compose exec backend bash

# æµ‹è¯• PostgreSQL è¿æ¥
ping poc-pg

# æµ‹è¯• Ollama è¿æ¥
curl http://poc-ollama:11434/api/tags

# é€€å‡ºå®¹å™¨
exit
```

### 3. æ£€æŸ¥æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs

# æŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs backend

# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker-compose logs frontend

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### 4. æµ‹è¯• API

```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8001/api/health

# æµ‹è¯• API æ–‡æ¡£
# æµè§ˆå™¨è®¿é—®: http://localhost:8001/api/docs
```

### 5. æµ‹è¯•å‰ç«¯

- æµè§ˆå™¨è®¿é—®: http://localhost
- å°è¯•ä¸Šä¼ æ–‡ä»¶
- å°è¯•å¯¹è¯åŠŸèƒ½

## å¸¸ç”¨å‘½ä»¤

### æœåŠ¡ç®¡ç†

```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# åœæ­¢æœåŠ¡
docker-compose down

# åœæ­¢å¹¶åˆ é™¤å·ï¼ˆæ³¨æ„ï¼šä¼šåˆ é™¤æ•°æ®ï¼‰
docker-compose down -v

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f frontend
```

### å®¹å™¨æ“ä½œ

```bash
# è¿›å…¥åç«¯å®¹å™¨
docker-compose exec backend bash

# è¿›å…¥å‰ç«¯å®¹å™¨
docker-compose exec frontend sh

# é‡å¯æœåŠ¡
docker-compose restart backend
docker-compose restart frontend

# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
docker stats
```

### æ•°æ®åº“æ“ä½œ

```bash
# æµ‹è¯•PostgreSQLè¿æ¥
docker-compose exec backend python -c "
from backend.services.db import _engine
if _engine:
    print('Database connection OK')
else:
    print('Database not configured')
"

# åˆå§‹åŒ–æ•°æ®åº“è¡¨
docker-compose exec backend python -c "
from backend.services.db import init_schema
init_schema()
print('Schema initialized')
"
```

### æ¸…ç†æ“ä½œ

```bash
# æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ
docker image prune

# æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨çš„èµ„æº
docker system prune -a

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ
docker system df
```

## æ•…éšœæ’æŸ¥

### 1. æ— æ³•è¿æ¥åˆ° PostgreSQL

**ç—‡çŠ¶ï¼š**

- åç«¯æ—¥å¿—æ˜¾ç¤ºæ•°æ®åº“è¿æ¥é”™è¯¯
- å¥åº·æ£€æŸ¥å¤±è´¥

**æ’æŸ¥æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥ä¸»é¡¹ç›® PostgreSQL æ˜¯å¦è¿è¡Œ
docker ps | grep poc-pg

# 2. æ£€æŸ¥ç½‘ç»œè¿æ¥
docker-compose exec backend ping poc-pg

# 3. æ£€æŸ¥ç¯å¢ƒå˜é‡
docker-compose exec backend env | grep DATABASE

# 4. æµ‹è¯•æ•°æ®åº“è¿æ¥
docker-compose exec backend python -c "
import psycopg2
try:
    conn = psycopg2.connect(
        host='poc-pg',
        port=5432,
        database='unified_db',
        user='admin',
        password='admin123'
    )
    print('Database connection OK')
    conn.close()
except Exception as e:
    print(f'Database connection failed: {e}')
"
```

**è§£å†³æ–¹æ¡ˆï¼š**

- ç¡®è®¤ä¸»é¡¹ç›®çš„ PostgreSQL å®¹å™¨æ­£åœ¨è¿è¡Œ
- ç¡®è®¤ `.env.docker` ä¸­çš„æ•°æ®åº“é…ç½®æ­£ç¡®
- ç¡®è®¤ç½‘ç»œ `dhcf-poc-fixed_core-net` å­˜åœ¨
- æ£€æŸ¥æ•°æ®åº“ç”¨æˆ·æƒé™

### 2. æ— æ³•è¿æ¥åˆ° Ollama

**ç—‡çŠ¶ï¼š**

- å¯¹è¯åŠŸèƒ½æ— æ³•ä½¿ç”¨
- åç«¯æ—¥å¿—æ˜¾ç¤º Ollama è¿æ¥é”™è¯¯

**æ’æŸ¥æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥ä¸»é¡¹ç›® Ollama æ˜¯å¦è¿è¡Œ
docker ps | grep poc-ollama

# 2. æ£€æŸ¥ç½‘ç»œè¿æ¥
docker-compose exec backend ping poc-ollama

# 3. æµ‹è¯• Ollama API
docker-compose exec backend curl http://poc-ollama:11434/api/tags

# 4. æ£€æŸ¥ç¯å¢ƒå˜é‡
docker-compose exec backend env | grep OLLAMA
```

**è§£å†³æ–¹æ¡ˆï¼š**

- ç¡®è®¤ä¸»é¡¹ç›®çš„ Ollama å®¹å™¨æ­£åœ¨è¿è¡Œ
- ç¡®è®¤ `.env.docker` ä¸­çš„ `OLLAMA_URL` æ­£ç¡®
- ç¡®è®¤æ¨¡å‹åç§° `OLLAMA_MODEL` æ­£ç¡®
- æ£€æŸ¥ Ollama æœåŠ¡æ˜¯å¦æ­£å¸¸å“åº”

### 3. å‰ç«¯æ— æ³•è®¿é—®åç«¯

**ç—‡çŠ¶ï¼š**

- å‰ç«¯é¡µé¢æ˜¾ç¤º API é”™è¯¯
- æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤ºç½‘ç»œé”™è¯¯

**æ’æŸ¥æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥åç«¯æœåŠ¡çŠ¶æ€
docker-compose ps backend

# 2. æ£€æŸ¥åç«¯æ—¥å¿—
docker-compose logs backend

# 3. æµ‹è¯•åç«¯å¥åº·æ£€æŸ¥
curl http://localhost:8001/api/health

# 4. æ£€æŸ¥å‰ç«¯æ—¥å¿—
docker-compose logs frontend
```

**è§£å†³æ–¹æ¡ˆï¼š**

- ç¡®è®¤åç«¯å®¹å™¨æ­£åœ¨è¿è¡Œ
- ç¡®è®¤ç«¯å£ 8001 æœªè¢«å ç”¨
- æ£€æŸ¥ Nginx é…ç½®æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹åç«¯æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

### 4. å®¹å™¨å¯åŠ¨å¤±è´¥

**ç—‡çŠ¶ï¼š**

- `docker-compose up -d` åå®¹å™¨ç«‹å³é€€å‡º
- `docker-compose ps` æ˜¾ç¤ºå®¹å™¨çŠ¶æ€ä¸º "Exited"

**æ’æŸ¥æ­¥éª¤ï¼š**

```bash
# 1. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs --tail=100 backend

# 2. æ£€æŸ¥ç«¯å£å ç”¨
# Windows
netstat -ano | findstr ":8001"
netstat -ano | findstr ":80"

# Linux/Mac
lsof -i :8001
lsof -i :80

# 3. æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la backend/uploads
ls -la backend/reports
```

**è§£å†³æ–¹æ¡ˆï¼š**

- æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Œä¿®æ”¹ `docker-compose.yml` ä¸­çš„ç«¯å£æ˜ å°„
- æ£€æŸ¥ `.env.docker` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
- æ£€æŸ¥æ–‡ä»¶æƒé™ï¼Œç¡®ä¿ç›®å½•å¯å†™
- æŸ¥çœ‹è¯¦ç»†æ—¥å¿—å®šä½å…·ä½“é”™è¯¯

### 5. ç½‘ç»œè¿æ¥é—®é¢˜

**ç—‡çŠ¶ï¼š**

- å®¹å™¨æ— æ³•è®¿é—®ä¸»é¡¹ç›®æœåŠ¡
- ç½‘ç»œ ping å¤±è´¥

**æ’æŸ¥æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥ç½‘ç»œæ˜¯å¦å­˜åœ¨
docker network ls | grep dhcf-poc-fixed_core-net

# 2. æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿æ¥åˆ°ç½‘ç»œ
docker network inspect dhcf-poc-fixed_core-net

# 3. æ£€æŸ¥ä¸»é¡¹ç›®å®¹å™¨æ˜¯å¦åœ¨åŒä¸€ç½‘ç»œ
docker inspect poc-pg | grep NetworkMode
docker inspect poc-ollama | grep NetworkMode
```

**è§£å†³æ–¹æ¡ˆï¼š**

- ç¡®è®¤ä¸»é¡¹ç›®ç½‘ç»œåç§°æ­£ç¡®ï¼ˆ`dhcf-poc-fixed_core-net`ï¼‰
- ç¡®è®¤ä¸»é¡¹ç›®å®¹å™¨åœ¨åŒä¸€ç½‘ç»œä¸­
- å¦‚æœç½‘ç»œåç§°ä¸åŒï¼Œä¿®æ”¹ `docker-compose.yml` ç¬¬ 101 è¡Œ

## å¸¸è§é—®é¢˜

### Q1: ç«¯å£ 8001 å·²è¢«å ç”¨æ€ä¹ˆåŠï¼Ÿ

**A:** ä¿®æ”¹ `docker-compose.yml` ä¸­çš„ç«¯å£æ˜ å°„ï¼š

```yaml
services:
  backend:
    ports:
      - "8002:8000" # æ”¹ä¸ºå…¶ä»–ç«¯å£ï¼Œå¦‚ 8002
```

ç„¶åè®¿é—® `http://localhost:8002`ã€‚

### Q2: å¦‚ä½•æŸ¥çœ‹ä¸»é¡¹ç›®çš„æ•°æ®åº“é…ç½®ï¼Ÿ

**A:** æŸ¥çœ‹ä¸»é¡¹ç›®çš„ `.env` æ–‡ä»¶æˆ– `docker-compose.yml` æ–‡ä»¶ï¼Œæ‰¾åˆ° PostgreSQL çš„é…ç½®ä¿¡æ¯ã€‚

### Q3: å¦‚ä½•ç¡®è®¤ä¸»é¡¹ç›®çš„æœåŠ¡åç§°ï¼Ÿ

**A:** æŸ¥çœ‹ä¸»é¡¹ç›®çš„ `docker-compose.yml` æ–‡ä»¶ï¼Œæ‰¾åˆ°æœåŠ¡å®šä¹‰éƒ¨åˆ†çš„åç§°ã€‚

### Q4: å¦‚ä½•æ›´æ–°ä»£ç åé‡æ–°éƒ¨ç½²ï¼Ÿ

**A:**

```bash
# åœæ­¢æœåŠ¡
docker-compose down

# é‡æ–°æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d
```

### Q5: æ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ

**A:** ä¸ä¼šã€‚æ•°æ®å­˜å‚¨åœ¨ä¸»æœºç›®å½•ä¸­ï¼ˆ`backend/uploads`ã€`backend/reports`ã€`backend/config_sessions`ï¼‰ï¼Œå³ä½¿åˆ é™¤å®¹å™¨ä¹Ÿä¸ä¼šä¸¢å¤±æ•°æ®ã€‚åªæœ‰ä½¿ç”¨ `docker-compose down -v` æ‰ä¼šåˆ é™¤å·æ•°æ®ã€‚

### Q6: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ

**A:** å¤‡ä»½ä»¥ä¸‹ç›®å½•ï¼š

```bash
# å¤‡ä»½ä¸Šä¼ çš„æ–‡ä»¶
cp -r backend/uploads /backup/uploads

# å¤‡ä»½ç”Ÿæˆçš„æŠ¥è¡¨
cp -r backend/reports /backup/reports

# å¤‡ä»½é…ç½®ä¼šè¯
cp -r backend/config_sessions /backup/config_sessions
```

### Q7: å¦‚ä½•æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼Ÿ

**A:**

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f backend
```

### Q8: å®¹å™¨æ— æ³•å¯åŠ¨ï¼Œå¦‚ä½•è°ƒè¯•ï¼Ÿ

**A:**

```bash
# 1. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs --tail=100 backend

# 2. è¿›å…¥å®¹å™¨è°ƒè¯•ï¼ˆå¦‚æœå®¹å™¨èƒ½å¯åŠ¨ï¼‰
docker-compose exec backend bash

# 3. æ‰‹åŠ¨è¿è¡Œå‘½ä»¤æµ‹è¯•
docker-compose run --rm backend bash
```

## æ¶æ„è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸»é¡¹ç›® Docker ç½‘ç»œ                  â”‚
â”‚  (dhcf-poc-fixed_core-net)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PostgreSQL  â”‚  â”‚   Ollama     â”‚ â”‚
â”‚  â”‚  (poc-pg)   â”‚  â”‚ (poc-ollama) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–²                â–²
           â”‚                â”‚
           â”‚  ç½‘ç»œè¿æ¥       â”‚
           â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DRIA Docker ç½‘ç»œ                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Backend    â”‚  â”‚  Frontend    â”‚  â”‚
â”‚  â”‚  (FastAPI)  â”‚  â”‚  (Nginx)     â”‚  â”‚
â”‚  â”‚  :8001      â”‚  â”‚  :80         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŒ‰ä»¥ä¸‹é¡ºåºæ£€æŸ¥ï¼š

1. âœ… Docker å’Œ Docker Compose ç‰ˆæœ¬
2. âœ… ä¸»é¡¹ç›®æœåŠ¡çŠ¶æ€ï¼ˆPostgreSQLã€Ollamaï¼‰
3. âœ… ä¸»é¡¹ç›®ç½‘ç»œæ˜¯å¦å­˜åœ¨
4. âœ… `.env.docker` æ–‡ä»¶é…ç½®
5. âœ… å®¹å™¨æ—¥å¿—è¾“å‡º
6. âœ… ç«¯å£å ç”¨æƒ…å†µ

---

**æç¤ºï¼š** å¦‚æœä¸»é¡¹ç›®é…ç½®ä¸æœ¬æ–‡æ¡£ä¸­çš„é»˜è®¤å€¼ä¸åŒï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ `.env.docker` æ–‡ä»¶ä¸­çš„é…ç½®é¡¹ã€‚
